# PDF ë Œë”ë§ ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬

PDF ë Œë”ë§ ì„±ëŠ¥ì„ ì¸¡ì •í•˜ê³  ë¹„êµí•˜ê¸° ìœ„í•œ ë²¤ì¹˜ë§ˆí¬ ë„êµ¬ ëª¨ìŒì…ë‹ˆë‹¤.

## ğŸ“ í…ŒìŠ¤íŠ¸ êµ¬ì¡°

```
bench/
â”œâ”€â”€ web-vitals/           # 1. ì›¹ ë°”ì´íƒˆ í…ŒìŠ¤íŠ¸
â”œâ”€â”€ rendering-scenarios/  # 2. ë‹¤ì–‘í•œ ë Œë”ë§ ìƒí™© í…ŒìŠ¤íŠ¸
â”œâ”€â”€ real-user-pattern/    # 3. ì‹¤ì‚¬ìš©ì íŒ¨í„´ í…ŒìŠ¤íŠ¸
â””â”€â”€ README.md            # ì´ íŒŒì¼
```

---

## 1ï¸âƒ£ ì›¹ ë°”ì´íƒˆ í…ŒìŠ¤íŠ¸ (`web-vitals/`)

### ëª©ì 
Googleì˜ Core Web Vitals ì§€í‘œë¥¼ ì¸¡ì •í•˜ì—¬ ì „ë°˜ì ì¸ ì›¹ ì„±ëŠ¥ì„ í‰ê°€í•©ë‹ˆë‹¤.

### ì¸¡ì • ì§€í‘œ
- **FCP** (First Contentful Paint): ì²« ì½˜í…ì¸  ë Œë”ë§ ì‹œê°„
- **LCP** (Largest Contentful Paint): ìµœëŒ€ ì½˜í…ì¸  ë Œë”ë§ ì‹œê°„
- **CLS** (Cumulative Layout Shift): ë ˆì´ì•„ì›ƒ ì´ë™ ì ìˆ˜
- **INP** (Interaction to Next Paint): ì¸í„°ë™ì…˜ ì‘ë‹µì„±
- **TTFB** (Time to First Byte): ì²« ë°”ì´íŠ¸ê¹Œì§€ì˜ ì‹œê°„
- **TTI** (Time to Interactive): ì¸í„°ë™í‹°ë¸Œ ê°€ëŠ¥ ì‹œê°„
- **TBT** (Total Blocking Time): ì´ ì°¨ë‹¨ ì‹œê°„

### ë¹„êµ ë²„ì „
1. **Basic** - `http://localhost:3000/feedback-basic/4` (ê¸°ë³¸ ë²„ì „)
2. **PDF** - `http://localhost:3000/feedback/4?version=pdf` (PDF ë²„ì „)
3. **Queue** - `http://localhost:3000/feedback/4?version=queue` (ìš°ì„ ìˆœìœ„ í ë²„ì „)

### ì‹¤í–‰ ë°©ë²•

```bash
# ê¸°ë³¸ ì‹¤í–‰ (3íšŒ, realistic í”„ë¦¬ì…‹)
cd web-vitals
./run-test.sh

# ì‹¤í–‰ íšŸìˆ˜ ì§€ì • (5íšŒ)
./run-test.sh 5

# í”„ë¦¬ì…‹ ë³€ê²½ (intensive: ì €ì‚¬ì–‘ í™˜ê²½ ì‹œë®¬ë ˆì´ì…˜)
./run-test.sh 5 intensive

# ì§ì ‘ ì‹¤í–‰ (ì„¸ë¶€ ì˜µì…˜ ì¡°ì •)
node bench-webvitals.js \
  --url1 "http://localhost:3000/feedback-basic/4" --name1 "Basic" \
  --url2 "http://localhost:3000/feedback/4?version=pdf" --name2 "PDF" \
  --url3 "http://localhost:3000/feedback/4?version=queue" --name3 "Queue" \
  --runs 3 \
  --preset realistic
```

### í”„ë¦¬ì…‹ ì˜µì…˜
- **fast**: ë¹ ë¥¸ ì¸¡ì • (2ì´ˆ ëŒ€ê¸°)
- **realistic**: ì‹¤ì œ í™˜ê²½ ì‹œë®¬ë ˆì´ì…˜ (7ì´ˆ ëŒ€ê¸°, ìŠ¤í¬ë¡¤, CPU 2x)
- **intensive**: ì €ì‚¬ì–‘ í™˜ê²½ (10ì´ˆ ëŒ€ê¸°, ìŠ¤í¬ë¡¤, CPU 4x)

### ê²°ê³¼ íŒŒì¼
- `./results/webvitals-[timestamp].json`

---

## 2ï¸âƒ£ ë Œë”ë§ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸ (`rendering-scenarios/`)

### ëª©ì 
ë‹¤ì–‘í•œ ìŠ¤í¬ë¡¤ ì†ë„ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ë Œë”ë§ íš¨ìœ¨ì„±ì„ ë¹„êµí•©ë‹ˆë‹¤.

### ì¸¡ì • ì‹œë‚˜ë¦¬ì˜¤
1. **ì ì§„ì  ìŠ¤í¬ë¡¤** (2ì´ˆ ëŒ€ê¸°)
   - ì¼ë°˜ì ì¸ ì‚¬ìš©ì íŒ¨í„´
   - ì²œì²œíˆ ë¬¸ì„œë¥¼ ì½ëŠ” ìƒí™©
   
2. **ë¹ ë¥¸ ìŠ¤í¬ë¡¤** (500ms ëŒ€ê¸°)
   - ë¹ ë¥´ê²Œ í›‘ì–´ë³´ëŠ” íŒ¨í„´
   - ì›í•˜ëŠ” ë‚´ìš©ì„ ì°¾ëŠ” ìƒí™©
   
3. **ë§¤ìš° ë¹ ë¥¸ ìŠ¤í¬ë¡¤** (200ms ëŒ€ê¸°)
   - ê·¹í•œ ìƒí™© í…ŒìŠ¤íŠ¸
   - ìš°ì„ ìˆœìœ„ íì˜ íš¨ê³¼ê°€ ê·¹ëŒ€í™”ë˜ëŠ” ìƒí™©

### ì¸¡ì • ì§€í‘œ
- ë Œë”ë§ íš¨ìœ¨ (pages/sec)
- ë Œë”ë§ëœ í˜ì´ì§€ ìˆ˜
- í˜ì´ì§€ë‹¹ í‰ê·  ë Œë”ë§ ì‹œê°„
- í”„ë ˆì„ ë“œë¡­ ìˆ˜
- ì´ˆê¸° ë·°í¬íŠ¸ í˜ì´ì§€ ì™„ë£Œ ì‹œê°„ â­
- ì¸í„°ë™ì…˜ ì‘ë‹µ ì‹œê°„
- Long Tasks ìˆ˜ & Total Blocking Time

### ë¹„êµ ë²„ì „
1. **PDF** - `http://localhost:3000/feedback/4?version=pdf`
2. **Queue** - `http://localhost:3000/feedback/4?version=queue`

### ì‹¤í–‰ ë°©ë²•

```bash
# ê¸°ë³¸ ì‹¤í–‰ (5íšŒ)
cd rendering-scenarios
./run-test.sh

# ì‹¤í–‰ íšŸìˆ˜ ì§€ì • (10íšŒ)
./run-test.sh 10

# ì§ì ‘ ì‹¤í–‰
node pdf-advanced-benchmark.js 5
```

### ê²°ê³¼ íŒŒì¼
- `./results/advanced-comparison-[timestamp].json`

---

## 3ï¸âƒ£ ì‹¤ì‚¬ìš©ì íŒ¨í„´ í…ŒìŠ¤íŠ¸ (`real-user-pattern/`)

### ëª©ì 
ì‹¤ì œ ì‚¬ìš©ìì˜ ë¬¸ì„œ ì½ê¸° íŒ¨í„´ì„ ì‹œë®¬ë ˆì´ì…˜í•˜ì—¬ ì„±ëŠ¥ì„ ì¸¡ì •í•©ë‹ˆë‹¤.

### ì‹œë®¬ë ˆì´ì…˜ íŒ¨í„´
1. ë¹ ë¥´ê²Œ ìŠ¤í¬ë¡¤í•˜ì—¬ ë‚´ìš© í›‘ì–´ë³´ê¸°
2. ê´€ì‹¬ ìˆëŠ” ë¶€ë¶„ì—ì„œ ì •ì§€í•˜ì—¬ ì½ê¸° (1.5ì´ˆ)
3. ì´ì „ ë‚´ìš© í™•ì¸ì„ ìœ„í•´ ìœ„ë¡œ ìŠ¤í¬ë¡¤í•˜ê¸°
4. ë°˜ë³µ

### ì¸¡ì • ì§€í‘œ
- ë Œë” ì´ë²¤íŠ¸ ìˆ˜
- ë Œë”ë§ íš¨ìœ¨ (pages/sec)
- sendWithPromise í˜¸ì¶œ ìˆ˜
- Long Tasks ë°œìƒ ë¹ˆë„
- Total Blocking Time
- ì´ë²¤íŠ¸ íƒ€ì„ë¼ì¸ ë¶„ì„
- ìƒê´€ê´€ê³„ ë¶„ì„ (ìŠ¤í¬ë¡¤ â†’ ë Œë”ë§ â†’ LongTask)

### ë¹„êµ ë²„ì „
1. **PDF** - `http://localhost:3000/feedback/4?version=pdf`
2. **Queue** - `http://localhost:3000/feedback/4?version=queue`

### ì‹¤í–‰ ë°©ë²•

```bash
# ê¸°ë³¸ ì‹¤í–‰ (3íšŒ, CPU 4x ê³ ì •)
cd real-user-pattern
./run-test.sh

# ì‹¤í–‰ íšŸìˆ˜ ì§€ì • (5íšŒ)
./run-test.sh 5

# CPU ìŠ¤ë¡œí‹€ë§ ë¹„êµ (4x vs 1x, ê° 3íšŒì”©) â­
./run-compare-cpu.sh 3

# ì§ì ‘ ì‹¤í–‰ (1íšŒë§Œ)
node bench-pdfjs-longtasks.js \
  --url1 "http://localhost:3000/feedback/4?version=pdf" --name1 "PDF" \
  --url2 "http://localhost:3000/feedback/4?version=queue" --name2 "Queue" \
  --cpu 4 \
  --realistic true
```

### CPU ìŠ¤ë¡œí‹€ë§ ë¹„êµ

`run-compare-cpu.sh` ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•˜ë©´ ì €ì‚¬ì–‘(4x)ê³¼ ì¼ë°˜(1x) í™˜ê²½ì„ ë™ì‹œì— í…ŒìŠ¤íŠ¸í•˜ê³  4ê°€ì§€ ë²„ì „ì„ í•œ ë²ˆì— ë¹„êµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
- **PDF-4x** vs **Queue-4x** (ì €ì‚¬ì–‘ í™˜ê²½)
- **PDF-1x** vs **Queue-1x** (ì¼ë°˜ í™˜ê²½)

### ê²°ê³¼ íŒŒì¼
- `./results/benchmark-results-[timestamp].json`

---

## ğŸ“Š ê²°ê³¼ í•´ì„

### 1. ì›¹ ë°”ì´íƒˆ ê¸°ì¤€

| ì§€í‘œ | Good âœ… | Needs Improvement âš ï¸ | Poor âŒ |
|------|---------|----------------------|---------|
| FCP  | < 1.8s  | 1.8s ~ 3.0s          | > 3.0s  |
| LCP  | < 2.5s  | 2.5s ~ 4.0s          | > 4.0s  |
| CLS  | < 0.1   | 0.1 ~ 0.25           | > 0.25  |
| INP  | < 200ms | 200ms ~ 500ms        | > 500ms |
| TTFB | < 800ms | -                    | > 800ms |
| TTI  | < 3.8s  | 3.8s ~ 7.3s          | > 7.3s  |
| TBT  | < 200ms | 200ms ~ 600ms        | > 600ms |

### 2. ë Œë”ë§ íš¨ìœ¨

- **ë Œë”ë§ íš¨ìœ¨** (pages/sec): ë†’ì„ìˆ˜ë¡ ì¢‹ìŒ
- **í”„ë ˆì„ ë“œë¡­**: ì ì„ìˆ˜ë¡ ì¢‹ìŒ
- **ë·°í¬íŠ¸ ì™„ë£Œ ì‹œê°„**: ì§§ì„ìˆ˜ë¡ ì¢‹ìŒ (â­ í•µì‹¬ ì§€í‘œ)

### 3. ì‘ë‹µì„±

- **Long Tasks**: 50ms ì´ìƒ ê±¸ë¦¬ëŠ” ì‘ì—…
- **Total Blocking Time**: Long Tasksì˜ 50ms ì´ˆê³¼ ë¶€ë¶„ í•©ê³„
- ì ì„ìˆ˜ë¡ ì‚¬ìš©ì ì¸í„°ë™ì…˜ì´ ë¶€ë“œëŸ¬ì›€

---

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### ì‚¬ì „ ì¤€ë¹„

1. Next.js ê°œë°œ ì„œë²„ ì‹¤í–‰
```bash
cd ../
npm run dev
```

2. í•„ìˆ˜ íŒ¨í‚¤ì§€ ì„¤ì¹˜
```bash
npm install puppeteer web-vitals
```

### ì „ì²´ í…ŒìŠ¤íŠ¸ í•œë²ˆì— ì‹¤í–‰ (ê¶Œì¥)

```bash
# ê¸°ë³¸ ëª¨ë“œ (ê° 3íšŒ)
./run-all-tests.sh

# ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ (ê° 1íšŒ)
./run-all-tests.sh quick

# ì „ì²´ í…ŒìŠ¤íŠ¸ (ê° 5íšŒ)
./run-all-tests.sh full
```

### ê°œë³„ í…ŒìŠ¤íŠ¸ ì‹¤í–‰

```bash
# 1. ì›¹ ë°”ì´íƒˆ í…ŒìŠ¤íŠ¸
cd web-vitals
./run-test.sh 3 realistic

# 2. ë Œë”ë§ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸
cd ../rendering-scenarios
./run-test.sh 5

# 3. ì‹¤ì‚¬ìš©ì íŒ¨í„´ í…ŒìŠ¤íŠ¸
cd ../real-user-pattern
./run-test.sh 3
```

---

## ğŸ’¡ íŒ

### ì •í™•í•œ ì¸¡ì •ì„ ìœ„í•œ ê¶Œì¥ì‚¬í•­

1. **ë°±ê·¸ë¼ìš´ë“œ í”„ë¡œì„¸ìŠ¤ ìµœì†Œí™”**
   - ë¶ˆí•„ìš”í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¢…ë£Œ
   - ë¸Œë¼ìš°ì € íƒ­ ì •ë¦¬

2. **ì—¬ëŸ¬ ë²ˆ ì‹¤í–‰í•˜ì—¬ í‰ê· ê°’ ì‚¬ìš©**
   - ìµœì†Œ 3íšŒ ì´ìƒ ì‹¤í–‰ ê¶Œì¥
   - ì´ìƒì¹˜(outlier)ëŠ” ì œì™¸

3. **ë™ì¼í•œ í™˜ê²½ì—ì„œ ë¹„êµ**
   - ê°™ì€ CPU throttle ì„¤ì •
   - ê°™ì€ ë„¤íŠ¸ì›Œí¬ í™˜ê²½
   - ê°™ì€ ì‹œê°„ëŒ€ (ì„œë²„ ë¶€í•˜ ê³ ë ¤)

4. **ê²°ê³¼ íŒŒì¼ ë°±ì—…**
   - ê° í…ŒìŠ¤íŠ¸ ê²°ê³¼ëŠ” íƒ€ì„ìŠ¤íƒ¬í”„ì™€ í•¨ê»˜ ì €ì¥ë¨
   - ì¤‘ìš”í•œ ê²°ê³¼ëŠ” ë³„ë„ ë°±ì—… ê¶Œì¥

---

## ğŸ“ˆ ì§€ì†ì ì¸ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§

### ìë™í™” ì˜ˆì œ

```bash
#!/bin/bash
# ë§¤ì¼ ì •í•´ì§„ ì‹œê°„ì— ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ (cron ì˜ˆì œ)

DATE=$(date +%Y-%m-%d)
LOG_DIR="./logs/${DATE}"
mkdir -p ${LOG_DIR}

# ì›¹ ë°”ì´íƒˆ
cd web-vitals
./run-test.sh 3 realistic > ${LOG_DIR}/web-vitals.log 2>&1

# ë Œë”ë§ ì‹œë‚˜ë¦¬ì˜¤
cd ../rendering-scenarios
./run-test.sh 5 > ${LOG_DIR}/rendering.log 2>&1

# ì‹¤ì‚¬ìš©ì íŒ¨í„´
cd ../real-user-pattern
./run-test.sh 3 > ${LOG_DIR}/real-user.log 2>&1
```

---

## ğŸ”§ ë¬¸ì œ í•´ê²°

### Puppeteer ê´€ë ¨

**ë¬¸ì œ**: Chromium ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨
```bash
# í•´ê²°
PUPPETEER_SKIP_CHROMIUM_DOWNLOAD=false npm install puppeteer
```

**ë¬¸ì œ**: "Cannot find module 'puppeteer'"
```bash
# í•´ê²°
npm install puppeteer
```

### ì¸¡ì • ê´€ë ¨

**ë¬¸ì œ**: ë Œë” ì´ë²¤íŠ¸ê°€ 0ê°œ
- ì›ì¸: pdfRenderMetricsCollectorê°€ ì œëŒ€ë¡œ ì‘ë™í•˜ì§€ ì•ŠìŒ
- í•´ê²°: í˜ì´ì§€ê°€ ì˜¬ë°”ë¥´ê²Œ ë¡œë“œë˜ì—ˆëŠ”ì§€ í™•ì¸

**ë¬¸ì œ**: web-vitals ê°’ì´ ëª¨ë‘ N/A
- ì›ì¸: web-vitals ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ ì‹¤íŒ¨ ë˜ëŠ” ëŒ€ê¸° ì‹œê°„ ë¶€ì¡±
- í•´ê²°: `--wait` ì‹œê°„ì„ ëŠ˜ë¦¬ê±°ë‚˜ `--scroll true` ì˜µì…˜ ì¶”ê°€

---

## ğŸ“ ë¼ì´ì„ ìŠ¤

ì´ ë²¤ì¹˜ë§ˆí¬ ë„êµ¬ëŠ” í”„ë¡œì íŠ¸ ë‚´ë¶€ì—ì„œ ì„±ëŠ¥ ì¸¡ì • ëª©ì ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.
